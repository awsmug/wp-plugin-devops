#!/bin/sh

# Getting path of this script - https://stackoverflow.com/questions/4774054/reliable-way-for-a-bash-script-to-get-the-full-path-to-itself
pushd `dirname $0` > /dev/null
export SCRIPT_PATH=`pwd -P`
popd > /dev/null

export BIN_PATH="${SCRIPT_PATH}/docker"

CONTAINER_PREFIX=$(basename $(dirname ${SCRIPT_PATH}))
CONTAINER_PREFIX=${CONTAINER_PREFIX// /}
CONTAINER_PREFIX=${CONTAINER_PREFIX//-/}_

export CONTAINER_PREFIX

export WP_CONTAINER_NAME="${CONTAINER_PREFIX}wp_1"

export PLUGIN_PATH=$(dirname $SCRIPT_PATH)
export PLUGIN_SLUG=$(basename $PLUGIN_PATH)
export DOCKER_COMPOSE_FILE="${PLUGIN_PATH}/docker-compose.yml"

if [ "$1" = "start" ]; then
    $BIN_PATH/start.sh

elif [ "$1" = "stop" ]; then
    $BIN_PATH/stop.sh

elif [ "$1" = "clean" ]; then
    $BIN_PATH/clean.sh

else
    echo "Usage: $(basename $0) <start|stop|clean>"
    exit 1
fi